!function(){"use strict";const n="\n  :host {\n    display: block;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;\n    --primary-color: #6366f1;\n    --primary-hover: #4f46e5;\n    --border-color: #e5e7eb;\n    --text-primary: #1f2937;\n    --text-secondary: #6b7280;\n    --bg-light: #f9fafb;\n    --bg-white: #ffffff;\n    --success-color: #10b981;\n    --error-color: #ef4444;\n    --warning-color: #f59e0b;\n  }\n\n  :host([theme=\"dark\"]) {\n    --border-color: #374151;\n    --text-primary: #f9fafb;\n    --text-secondary: #9ca3af;\n    --bg-light: #1f2937;\n    --bg-white: #111827;\n  }\n\n  * {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n  }\n\n  .checkout-container {\n    max-width: 420px;\n    margin: 0 auto;\n    background: var(--bg-white);\n    border-radius: 16px;\n    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.12);\n    overflow: hidden;\n  }\n\n  /* Header with amount */\n  .checkout-header {\n    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);\n    color: white;\n    padding: 24px;\n    text-align: center;\n  }\n\n  .checkout-logo {\n    width: 48px;\n    height: 48px;\n    background: rgba(255,255,255,0.2);\n    border-radius: 12px;\n    margin: 0 auto 12px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 24px;\n  }\n\n  .checkout-amount {\n    font-size: 32px;\n    font-weight: 700;\n    margin-bottom: 4px;\n  }\n\n  .checkout-label {\n    font-size: 14px;\n    opacity: 0.9;\n  }\n\n  /* Mandate Info Bar */\n  .mandate-info {\n    display: flex;\n    justify-content: space-around;\n    padding: 16px;\n    background: var(--bg-light);\n    border-bottom: 1px solid var(--border-color);\n  }\n\n  .info-item {\n    text-align: center;\n  }\n\n  .info-label {\n    font-size: 11px;\n    color: var(--text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    margin-bottom: 4px;\n  }\n\n  .info-value {\n    font-size: 13px;\n    font-weight: 600;\n    color: var(--text-primary);\n  }\n\n  /* Payment Methods */\n  .payment-methods {\n    padding: 20px;\n  }\n\n  .section-title {\n    font-size: 13px;\n    font-weight: 600;\n    color: var(--text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    margin-bottom: 12px;\n  }\n\n  .payment-option {\n    display: flex;\n    align-items: center;\n    padding: 16px;\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    margin-bottom: 12px;\n    cursor: pointer;\n    transition: all 0.2s;\n  }\n\n  .payment-option:hover {\n    border-color: var(--primary-color);\n    background: rgba(99, 102, 241, 0.04);\n  }\n\n  .payment-option.selected {\n    border-color: var(--primary-color);\n    background: rgba(99, 102, 241, 0.08);\n  }\n\n  .payment-option.disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .payment-icon {\n    width: 44px;\n    height: 44px;\n    background: var(--bg-light);\n    border-radius: 10px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 20px;\n    margin-right: 14px;\n  }\n\n  .payment-details {\n    flex: 1;\n  }\n\n  .payment-name {\n    font-size: 15px;\n    font-weight: 600;\n    color: var(--text-primary);\n    margin-bottom: 2px;\n  }\n\n  .payment-desc {\n    font-size: 12px;\n    color: var(--text-secondary);\n  }\n\n  .payment-check {\n    width: 22px;\n    height: 22px;\n    border: 2px solid var(--border-color);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 12px;\n    color: transparent;\n    transition: all 0.2s;\n  }\n\n  .payment-option.selected .payment-check {\n    background: var(--primary-color);\n    border-color: var(--primary-color);\n    color: white;\n  }\n\n  /* Expanded Payment Form */\n  .payment-form {\n    padding: 0 20px 20px;\n    display: none;\n  }\n\n  .payment-form.active {\n    display: block;\n  }\n\n  .form-section {\n    background: var(--bg-light);\n    border-radius: 12px;\n    padding: 16px;\n  }\n\n  /* Bank Grid */\n  .bank-grid {\n    display: grid;\n    grid-template-columns: repeat(4, 1fr);\n    gap: 8px;\n    margin-bottom: 12px;\n  }\n\n  .bank-item {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 10px 4px;\n    border: 1px solid var(--border-color);\n    border-radius: 8px;\n    cursor: pointer;\n    transition: all 0.2s;\n    background: var(--bg-white);\n  }\n\n  .bank-item:hover {\n    border-color: var(--primary-color);\n  }\n\n  .bank-item.selected {\n    border-color: var(--primary-color);\n    background: rgba(99, 102, 241, 0.1);\n  }\n\n  .bank-logo {\n    width: 32px;\n    height: 32px;\n    background: var(--bg-light);\n    border-radius: 6px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 10px;\n    font-weight: 700;\n    color: var(--text-primary);\n    margin-bottom: 6px;\n  }\n\n  .bank-name {\n    font-size: 9px;\n    color: var(--text-secondary);\n    text-align: center;\n    line-height: 1.2;\n  }\n\n  /* Input Fields */\n  .input-group {\n    margin-bottom: 12px;\n  }\n\n  .input-label {\n    display: block;\n    font-size: 12px;\n    font-weight: 500;\n    color: var(--text-primary);\n    margin-bottom: 6px;\n  }\n\n  .input-field {\n    width: 100%;\n    padding: 12px 14px;\n    border: 1px solid var(--border-color);\n    border-radius: 8px;\n    font-size: 14px;\n    background: var(--bg-white);\n    color: var(--text-primary);\n    outline: none;\n    transition: border-color 0.2s;\n  }\n\n  .input-field:focus {\n    border-color: var(--primary-color);\n  }\n\n  .input-field::placeholder {\n    color: var(--text-secondary);\n  }\n\n  .input-row {\n    display: flex;\n    gap: 12px;\n  }\n\n  .input-row .input-group {\n    flex: 1;\n  }\n\n  .input-hint {\n    font-size: 11px;\n    color: var(--text-secondary);\n    margin-top: 6px;\n  }\n\n  /* Footer / CTA */\n  .checkout-footer {\n    padding: 20px;\n    border-top: 1px solid var(--border-color);\n  }\n\n  .btn-authorize {\n    width: 100%;\n    padding: 16px;\n    background: var(--primary-color);\n    color: white;\n    border: none;\n    border-radius: 12px;\n    font-size: 16px;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.2s;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n  }\n\n  .btn-authorize:hover:not(:disabled) {\n    background: var(--primary-hover);\n    transform: translateY(-1px);\n  }\n\n  .btn-authorize:disabled {\n    background: #9ca3af;\n    cursor: not-allowed;\n    transform: none;\n  }\n\n  .secure-badge {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 6px;\n    margin-top: 12px;\n    font-size: 11px;\n    color: var(--text-secondary);\n  }\n\n  /* Loading */\n  .loading-container {\n    padding: 60px 20px;\n    text-align: center;\n  }\n\n  .spinner {\n    width: 40px;\n    height: 40px;\n    border: 3px solid var(--border-color);\n    border-top-color: var(--primary-color);\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n    margin: 0 auto 16px;\n  }\n\n  @keyframes spin {\n    to { transform: rotate(360deg); }\n  }\n\n  .loading-text {\n    font-size: 14px;\n    color: var(--text-secondary);\n  }\n\n  /* Result States */\n  .result-container {\n    padding: 48px 24px;\n    text-align: center;\n  }\n\n  .result-icon {\n    width: 72px;\n    height: 72px;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin: 0 auto 20px;\n    font-size: 36px;\n  }\n\n  .result-icon.success {\n    background: rgba(16, 185, 129, 0.1);\n    color: var(--success-color);\n  }\n\n  .result-icon.error {\n    background: rgba(239, 68, 68, 0.1);\n    color: var(--error-color);\n  }\n\n  .result-title {\n    font-size: 22px;\n    font-weight: 600;\n    color: var(--text-primary);\n    margin-bottom: 8px;\n  }\n\n  .result-message {\n    font-size: 14px;\n    color: var(--text-secondary);\n    line-height: 1.5;\n  }\n\n  .result-footer {\n    padding: 20px;\n  }\n\n  .btn-done {\n    width: 100%;\n    padding: 14px;\n    background: var(--primary-color);\n    color: white;\n    border: none;\n    border-radius: 10px;\n    font-size: 15px;\n    font-weight: 600;\n    cursor: pointer;\n  }\n\n  .btn-retry {\n    background: var(--bg-light);\n    color: var(--text-primary);\n  }\n",e=[{code:"HDFC",name:"HDFC"},{code:"ICICI",name:"ICICI"},{code:"SBI",name:"SBI"},{code:"AXIS",name:"Axis"},{code:"KOTAK",name:"Kotak"},{code:"YES",name:"Yes Bank"},{code:"PNB",name:"PNB"},{code:"BOB",name:"BOB"}];class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.state={isLoading:!0,selectedMethod:null,selectedBank:null,upiId:"",cardNumber:"",cardExpiry:"",cardCvv:"",result:null,mandateDetails:null}}static get observedAttributes(){return["session-id","return-url","environment","theme"]}connectedCallback(){this.loadMandateDetails()}attributeChangedCallback(n,e,t){e!==t&&"session-id"===n&&this.loadMandateDetails()}get sessionId(){return this.getAttribute("session-id")}get returnUrl(){return this.getAttribute("return-url")}get environment(){return this.getAttribute("environment")||"sandbox"}async loadMandateDetails(){this.state.isLoading=!0,this.render(),await new Promise(n=>setTimeout(n,800)),this.state.mandateDetails={amount:"‚Çπ999",frequency:"Monthly",validity:"Until cancelled",merchantName:"BillHive",mandateId:this.sessionId||"MND_123456"},this.state.isLoading=!1,this.render(),this.attachEventListeners()}render(){const{isLoading:e,result:t,mandateDetails:a}=this.state;e?this.shadowRoot.innerHTML=`\n        <style>${n}</style>\n        <div class="checkout-container">\n          <div class="loading-container">\n            <div class="spinner"></div>\n            <div class="loading-text">Loading checkout...</div>\n          </div>\n        </div>\n      `:t?this.renderResult():this.renderCheckout()}renderCheckout(){const{selectedMethod:t,selectedBank:a,mandateDetails:i}=this.state;this.shadowRoot.innerHTML=`\n      <style>${n}</style>\n      <div class="checkout-container">\n        \x3c!-- Header --\x3e\n        <div class="checkout-header">\n          <div class="checkout-logo">üîê</div>\n          <div class="checkout-amount">${i.amount}</div>\n          <div class="checkout-label">Authorize Mandate</div>\n        </div>\n\n        \x3c!-- Mandate Info --\x3e\n        <div class="mandate-info">\n          <div class="info-item">\n            <div class="info-label">Frequency</div>\n            <div class="info-value">${i.frequency}</div>\n          </div>\n          <div class="info-item">\n            <div class="info-label">Validity</div>\n            <div class="info-value">${i.validity}</div>\n          </div>\n          <div class="info-item">\n            <div class="info-label">Merchant</div>\n            <div class="info-value">${i.merchantName}</div>\n          </div>\n        </div>\n\n        \x3c!-- Payment Methods --\x3e\n        <div class="payment-methods">\n          <div class="section-title">Select Payment Method</div>\n\n          \x3c!-- UPI AutoPay --\x3e\n          <div class="payment-option ${"upi"===t?"selected":""}" data-method="upi">\n            <div class="payment-icon">üì±</div>\n            <div class="payment-details">\n              <div class="payment-name">UPI AutoPay</div>\n              <div class="payment-desc">Pay using any UPI app</div>\n            </div>\n            <div class="payment-check">‚úì</div>\n          </div>\n\n          \x3c!-- Net Banking --\x3e\n          <div class="payment-option ${"netbanking"===t?"selected":""}" data-method="netbanking">\n            <div class="payment-icon">üè¶</div>\n            <div class="payment-details">\n              <div class="payment-name">Net Banking</div>\n              <div class="payment-desc">e-Mandate via bank account</div>\n            </div>\n            <div class="payment-check">‚úì</div>\n          </div>\n\n          \x3c!-- Debit/Credit Card --\x3e\n          <div class="payment-option ${"card"===t?"selected":""}" data-method="card">\n            <div class="payment-icon">üí≥</div>\n            <div class="payment-details">\n              <div class="payment-name">Debit / Credit Card</div>\n              <div class="payment-desc">Standing instruction on card</div>\n            </div>\n            <div class="payment-check">‚úì</div>\n          </div>\n        </div>\n\n        \x3c!-- UPI Form --\x3e\n        <div class="payment-form ${"upi"===t?"active":""}" id="upi-form">\n          <div class="form-section">\n            <div class="input-group">\n              <label class="input-label">Enter UPI ID</label>\n              <input type="text" class="input-field" id="upi-input" placeholder="yourname@upi" value="${this.state.upiId}">\n              <div class="input-hint">You'll receive a collect request on your UPI app</div>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Net Banking Form --\x3e\n        <div class="payment-form ${"netbanking"===t?"active":""}" id="netbanking-form">\n          <div class="form-section">\n            <div class="section-title" style="margin-top: 0;">Select Your Bank</div>\n            <div class="bank-grid">\n              ${e.map(n=>`\n                <div class="bank-item ${a===n.code?"selected":""}" data-bank="${n.code}">\n                  <div class="bank-logo">${n.code.substring(0,2)}</div>\n                  <div class="bank-name">${n.name}</div>\n                </div>\n              `).join("")}\n            </div>\n            <input type="text" class="input-field" placeholder="Search other banks..." id="bank-search">\n          </div>\n        </div>\n\n        \x3c!-- Card Form --\x3e\n        <div class="payment-form ${"card"===t?"active":""}" id="card-form">\n          <div class="form-section">\n            <div class="input-group">\n              <label class="input-label">Card Number</label>\n              <input type="text" class="input-field" id="card-number" placeholder="1234 5678 9012 3456" maxlength="19">\n            </div>\n            <div class="input-row">\n              <div class="input-group">\n                <label class="input-label">Expiry</label>\n                <input type="text" class="input-field" id="card-expiry" placeholder="MM/YY" maxlength="5">\n              </div>\n              <div class="input-group">\n                <label class="input-label">CVV</label>\n                <input type="password" class="input-field" id="card-cvv" placeholder="‚Ä¢‚Ä¢‚Ä¢" maxlength="4">\n              </div>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Footer --\x3e\n        <div class="checkout-footer">\n          <button class="btn-authorize" id="authorize-btn" ${this.canProceed()?"":"disabled"}>\n            <span>üîí</span>\n            <span>Authorize Mandate</span>\n          </button>\n          <div class="secure-badge">\n            <span>üõ°Ô∏è</span>\n            <span>Secured by 256-bit encryption</span>\n          </div>\n        </div>\n      </div>\n    `}renderResult(){const{result:e}=this.state,t="success"===e.type;this.shadowRoot.innerHTML=`\n      <style>${n}</style>\n      <div class="checkout-container">\n        <div class="result-container">\n          <div class="result-icon ${t?"success":"error"}">\n            ${t?"‚úì":"‚úï"}\n          </div>\n          <div class="result-title">${t?"Mandate Authorized!":"Authorization Failed"}</div>\n          <div class="result-message">${e.message}</div>\n        </div>\n        <div class="result-footer">\n          <button class="btn-done ${t?"":"btn-retry"}" id="done-btn">\n            ${t?"Done":"Try Again"}\n          </button>\n        </div>\n      </div>\n    `,this.shadowRoot.getElementById("done-btn").addEventListener("click",()=>{t&&this.returnUrl?window.location.href=this.returnUrl:t||(this.state.result=null,this.render(),this.attachEventListeners())})}canProceed(){const{selectedMethod:n,selectedBank:e,upiId:t,cardNumber:a,cardExpiry:i,cardCvv:r}=this.state;if(!n)return!1;switch(n){case"upi":return t.includes("@");case"netbanking":return null!==e;case"card":return a.replace(/\s/g,"").length>=15&&5===i.length&&r.length>=3;default:return!1}}attachEventListeners(){this.shadowRoot.querySelectorAll(".payment-option").forEach(n=>{n.addEventListener("click",n=>{this.state.selectedMethod=n.currentTarget.dataset.method,this.render(),this.attachEventListeners()})}),this.shadowRoot.querySelectorAll(".bank-item").forEach(n=>{n.addEventListener("click",n=>{this.state.selectedBank=n.currentTarget.dataset.bank,this.render(),this.attachEventListeners()})});const n=this.shadowRoot.getElementById("upi-input");n&&(n.addEventListener("input",n=>{this.state.upiId=n.target.value,this.updateButton()}),n.focus());const e=this.shadowRoot.getElementById("card-number");e&&e.addEventListener("input",n=>{let e=n.target.value.replace(/\D/g,"");e=e.replace(/(\d{4})(?=\d)/g,"$1 "),n.target.value=e,this.state.cardNumber=e,this.updateButton()});const t=this.shadowRoot.getElementById("card-expiry");t&&t.addEventListener("input",n=>{let e=n.target.value.replace(/\D/g,"");e.length>=2&&(e=e.substring(0,2)+"/"+e.substring(2)),n.target.value=e,this.state.cardExpiry=e,this.updateButton()});const a=this.shadowRoot.getElementById("card-cvv");a&&a.addEventListener("input",n=>{this.state.cardCvv=n.target.value,this.updateButton()});const i=this.shadowRoot.getElementById("authorize-btn");i&&i.addEventListener("click",()=>this.handleAuthorize())}updateButton(){const n=this.shadowRoot.getElementById("authorize-btn");n&&(n.disabled=!this.canProceed())}async handleAuthorize(){const n=this.shadowRoot.getElementById("authorize-btn");n.disabled=!0,n.innerHTML='<div class="spinner" style="width:20px;height:20px;border-width:2px;margin:0;"></div>';try{await new Promise(n=>setTimeout(n,2e3));const n=this.buildPayload();this.state.result={type:"success",message:"Your mandate has been authorized successfully. Payments will be debited automatically as per schedule."},this.dispatchEvent(new CustomEvent("mandate-success",{detail:{sessionId:this.sessionId,payload:n},bubbles:!0,composed:!0}))}catch(e){this.state.result={type:"error",message:e.message||"Failed to authorize. Please try again."},this.dispatchEvent(new CustomEvent("mandate-failure",{detail:{sessionId:this.sessionId,error:e.message},bubbles:!0,composed:!0}))}this.render()}buildPayload(){const{selectedMethod:n,selectedBank:e,upiId:t,cardNumber:a,cardExpiry:i}=this.state;return{sessionId:this.sessionId,method:n,..."netbanking"===n&&{bankCode:e},..."upi"===n&&{upiId:t},..."card"===n&&{cardLast4:a.slice(-4),expiry:i}}}}customElements.define("approve-mandate",t)}();
