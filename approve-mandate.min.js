!function(){"use strict";const n="\n  :host {\n    display: block;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;\n    --primary: #0d9488;\n    --primary-hover: #0f766e;\n    --border-color: #d3d3d3;\n    --text-primary: #374151;\n    --text-secondary: #6b7280;\n    --text-muted: #9ca3af;\n    --bg-white: #ffffff;\n    --bg-light: #f9fafb;\n    --bg-hover: #f3f4f6;\n    --success: #10b981;\n    --error: #ef4444;\n  }\n\n  :host([theme=\"dark\"]) {\n    --border-color: #3b3f5c;\n    --text-primary: #e5e7eb;\n    --text-secondary: #9ca3af;\n    --text-muted: #6b7280;\n    --bg-white: #1b2e4b;\n    --bg-light: #0e1726;\n    --bg-hover: #263959;\n  }\n\n  * {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n  }\n\n  .container {\n    max-width: 480px;\n    margin: 0 auto;\n    padding: 16px;\n  }\n\n  /* Header */\n  .header {\n    text-align: center;\n    padding: 20px;\n    margin-bottom: 16px;\n  }\n\n  .header-title {\n    font-size: 18px;\n    font-weight: 600;\n    color: var(--text-primary);\n    margin-bottom: 8px;\n  }\n\n  .header-amount {\n    font-size: 28px;\n    font-weight: 700;\n    color: var(--primary);\n  }\n\n  .mandate-info {\n    display: flex;\n    justify-content: center;\n    gap: 24px;\n    margin-top: 12px;\n  }\n\n  .mandate-info-item {\n    text-align: center;\n  }\n\n  .mandate-info-label {\n    font-size: 11px;\n    color: var(--text-muted);\n    text-transform: uppercase;\n  }\n\n  .mandate-info-value {\n    font-size: 13px;\n    font-weight: 600;\n    color: var(--text-secondary);\n  }\n\n  /* Section Title */\n  .section-title {\n    font-size: 14px;\n    font-weight: 600;\n    color: var(--text-primary);\n    margin-bottom: 12px;\n  }\n\n  /* Accordion Container */\n  .accordion-container {\n    border: 1px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    background: var(--bg-white);\n  }\n\n  /* Accordion Item */\n  .accordion-item {\n    border-bottom: 1px solid var(--border-color);\n  }\n\n  .accordion-item:last-child {\n    border-bottom: none;\n  }\n\n  /* Accordion Header */\n  .accordion-header {\n    display: flex;\n    align-items: center;\n    width: 100%;\n    padding: 16px;\n    background: var(--bg-white);\n    border: none;\n    cursor: pointer;\n    text-align: left;\n    transition: background 0.2s;\n  }\n\n  .accordion-header:hover {\n    background: var(--bg-hover);\n  }\n\n  .accordion-header.active {\n    color: var(--primary);\n  }\n\n  .accordion-icon {\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin-right: 12px;\n    font-size: 20px;\n    color: var(--primary);\n  }\n\n  .accordion-details {\n    flex: 1;\n  }\n\n  .accordion-title {\n    font-size: 14px;\n    font-weight: 600;\n    color: var(--text-primary);\n  }\n\n  .accordion-header.active .accordion-title {\n    color: var(--primary);\n  }\n\n  .accordion-desc {\n    font-size: 12px;\n    color: var(--text-muted);\n    margin-top: 2px;\n  }\n\n  .accordion-chevron {\n    font-size: 12px;\n    color: var(--text-muted);\n    transition: transform 0.2s;\n  }\n\n  .accordion-header.active .accordion-chevron {\n    transform: rotate(180deg);\n  }\n\n  /* Accordion Content */\n  .accordion-content {\n    max-height: 0;\n    overflow: hidden;\n    transition: max-height 0.3s ease-out;\n    background: var(--bg-light);\n  }\n\n  .accordion-content.open {\n    max-height: 500px;\n  }\n\n  .accordion-body {\n    padding: 16px;\n  }\n\n  /* Form Elements */\n  .form-group {\n    margin-bottom: 12px;\n  }\n\n  .form-label {\n    display: block;\n    font-size: 12px;\n    font-weight: 500;\n    color: var(--text-primary);\n    margin-bottom: 6px;\n  }\n\n  .form-input {\n    width: 100%;\n    padding: 10px 12px;\n    border: 1px solid var(--border-color);\n    border-radius: 6px;\n    font-size: 14px;\n    background: var(--bg-white);\n    color: var(--text-primary);\n    outline: none;\n    transition: border-color 0.2s;\n  }\n\n  .form-input:focus {\n    border-color: var(--primary);\n  }\n\n  .form-input::placeholder {\n    color: var(--text-muted);\n  }\n\n  .form-hint {\n    font-size: 11px;\n    color: var(--text-muted);\n    margin-top: 4px;\n  }\n\n  .form-row {\n    display: flex;\n    gap: 12px;\n  }\n\n  .form-row .form-group {\n    flex: 1;\n  }\n\n  .form-checkbox {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 12px;\n    color: var(--text-secondary);\n    margin-top: 12px;\n  }\n\n  .form-checkbox input {\n    width: 16px;\n    height: 16px;\n    accent-color: var(--primary);\n  }\n\n  /* Bank List */\n  .bank-list {\n    margin-top: 8px;\n  }\n\n  .bank-item {\n    display: flex;\n    align-items: center;\n    padding: 12px;\n    border-bottom: 1px solid var(--border-color);\n    cursor: pointer;\n    transition: background 0.2s;\n  }\n\n  .bank-item:last-child {\n    border-bottom: none;\n  }\n\n  .bank-item:hover {\n    background: var(--bg-hover);\n  }\n\n  .bank-item.selected {\n    background: rgba(13, 148, 136, 0.1);\n  }\n\n  .bank-icon {\n    width: 36px;\n    height: 36px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: var(--bg-light);\n    border-radius: 6px;\n    font-size: 12px;\n    font-weight: 700;\n    color: var(--primary);\n    margin-right: 12px;\n  }\n\n  .bank-name {\n    flex: 1;\n    font-size: 14px;\n    font-weight: 500;\n    color: var(--text-primary);\n  }\n\n  .bank-chevron {\n    font-size: 12px;\n    color: var(--text-muted);\n  }\n\n  /* Primary Button */\n  .btn-primary {\n    width: 100%;\n    padding: 12px 16px;\n    background: var(--primary);\n    color: white;\n    border: none;\n    border-radius: 6px;\n    font-size: 14px;\n    font-weight: 600;\n    cursor: pointer;\n    transition: background 0.2s;\n    margin-top: 12px;\n  }\n\n  .btn-primary:hover:not(:disabled) {\n    background: var(--primary-hover);\n  }\n\n  .btn-primary:disabled {\n    background: #9ca3af;\n    cursor: not-allowed;\n  }\n\n  /* Loading */\n  .loading-container {\n    padding: 60px 20px;\n    text-align: center;\n  }\n\n  .spinner {\n    width: 32px;\n    height: 32px;\n    border: 3px solid var(--border-color);\n    border-top-color: var(--primary);\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n    margin: 0 auto 12px;\n  }\n\n  @keyframes spin {\n    to { transform: rotate(360deg); }\n  }\n\n  .loading-text {\n    font-size: 14px;\n    color: var(--text-secondary);\n  }\n\n  /* Result States */\n  .result-container {\n    padding: 48px 24px;\n    text-align: center;\n  }\n\n  .result-icon {\n    width: 64px;\n    height: 64px;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin: 0 auto 16px;\n    font-size: 28px;\n  }\n\n  .result-icon.success {\n    background: rgba(16, 185, 129, 0.1);\n    color: var(--success);\n  }\n\n  .result-icon.error {\n    background: rgba(239, 68, 68, 0.1);\n    color: var(--error);\n  }\n\n  .result-title {\n    font-size: 20px;\n    font-weight: 600;\n    color: var(--text-primary);\n    margin-bottom: 8px;\n  }\n\n  .result-message {\n    font-size: 14px;\n    color: var(--text-secondary);\n    line-height: 1.5;\n  }\n\n  .result-footer {\n    padding: 20px;\n  }\n\n  .btn-done {\n    width: 100%;\n    padding: 12px;\n    background: var(--primary);\n    color: white;\n    border: none;\n    border-radius: 6px;\n    font-size: 14px;\n    font-weight: 600;\n    cursor: pointer;\n  }\n\n  .btn-retry {\n    background: var(--bg-light);\n    color: var(--text-primary);\n    border: 1px solid var(--border-color);\n  }\n\n  /* SVG Icons */\n  .icon {\n    width: 24px;\n    height: 24px;\n  }\n",e=[{code:"HDFC",name:"HDFC Bank"},{code:"ICICI",name:"ICICI Bank"},{code:"SBI",name:"State Bank of India"},{code:"AXIS",name:"Axis Bank"},{code:"KOTAK",name:"Kotak Mahindra Bank"},{code:"YES",name:"Yes Bank"},{code:"PNB",name:"Punjab National Bank"},{code:"BOB",name:"Bank of Baroda"}],t='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>',a='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"/></svg>',i='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M4 10v7h3v-7H4zm6 0v7h3v-7h-3zM2 22h19v-3H2v3zm14-12v7h3v-7h-3zm-4.5-9L2 6v2h19V6l-9.5-5z"/></svg>',r='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>',o='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>',d='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>';class s extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.state={isLoading:!0,activeAccordion:null,selectedBank:null,upiId:"",cardNumber:"",cardExpiry:"",cardCvv:"",cardHolder:"",result:null,mandateDetails:null}}static get observedAttributes(){return["session-id","return-url","environment","theme"]}connectedCallback(){this.loadMandateDetails()}attributeChangedCallback(n,e,t){e!==t&&"session-id"===n&&this.loadMandateDetails()}get sessionId(){return this.getAttribute("session-id")}get returnUrl(){return this.getAttribute("return-url")}get environment(){return this.getAttribute("environment")||"sandbox"}async loadMandateDetails(){this.state.isLoading=!0,this.render(),await new Promise(n=>setTimeout(n,800)),this.state.mandateDetails={amount:"999",currency:"₹",frequency:"Monthly",validity:"Until cancelled",merchantName:"BillHive",mandateId:this.sessionId||"MND_123456"},this.state.isLoading=!1,this.render(),this.attachEventListeners()}render(){const{isLoading:e,result:t}=this.state;e?this.shadowRoot.innerHTML=`\n        <style>${n}</style>\n        <div class="container">\n          <div class="loading-container">\n            <div class="spinner"></div>\n            <div class="loading-text">Loading...</div>\n          </div>\n        </div>\n      `:t?this.renderResult():this.renderCheckout()}renderCheckout(){const{activeAccordion:o,selectedBank:s,mandateDetails:c}=this.state;this.shadowRoot.innerHTML=`\n      <style>${n}</style>\n      <div class="container">\n        \x3c!-- Header --\x3e\n        <div class="header">\n          <div class="header-title">Authorize Mandate</div>\n          <div class="header-amount">${c.currency}${c.amount}</div>\n          <div class="mandate-info">\n            <div class="mandate-info-item">\n              <div class="mandate-info-label">Frequency</div>\n              <div class="mandate-info-value">${c.frequency}</div>\n            </div>\n            <div class="mandate-info-item">\n              <div class="mandate-info-label">Validity</div>\n              <div class="mandate-info-value">${c.validity}</div>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Payment Options --\x3e\n        <div class="section-title">Payment Options</div>\n        <div class="accordion-container">\n\n          \x3c!-- UPI AutoPay --\x3e\n          <div class="accordion-item">\n            <button class="accordion-header ${"upi"===o?"active":""}" data-accordion="upi">\n              <div class="accordion-icon">${t}</div>\n              <div class="accordion-details">\n                <div class="accordion-title">UPI AutoPay</div>\n                <div class="accordion-desc">You need to have a registered UPI ID</div>\n              </div>\n              <div class="accordion-chevron">${r}</div>\n            </button>\n            <div class="accordion-content ${"upi"===o?"open":""}">\n              <div class="accordion-body">\n                <div class="form-group">\n                  <input type="text" class="form-input" id="upi-input" placeholder="Enter your UPI ID" value="${this.state.upiId}">\n                  <div class="form-hint">You'll receive a mandate request on your UPI app</div>\n                </div>\n                <label class="form-checkbox">\n                  <input type="checkbox" checked>\n                  Save UPI ID for future payments\n                </label>\n                <button class="btn-primary" id="upi-submit" ${this.state.upiId.includes("@")?"":"disabled"}>\n                  Verify & Authorize\n                </button>\n              </div>\n            </div>\n          </div>\n\n          \x3c!-- Card --\x3e\n          <div class="accordion-item">\n            <button class="accordion-header ${"card"===o?"active":""}" data-accordion="card">\n              <div class="accordion-icon">${a}</div>\n              <div class="accordion-details">\n                <div class="accordion-title">Debit / Credit Card</div>\n                <div class="accordion-desc">Standing instruction on card</div>\n              </div>\n              <div class="accordion-chevron">${r}</div>\n            </button>\n            <div class="accordion-content ${"card"===o?"open":""}">\n              <div class="accordion-body">\n                <div class="form-group">\n                  <label class="form-label">Card Number</label>\n                  <input type="text" class="form-input" id="card-number" placeholder="1234 5678 9012 3456" maxlength="19">\n                </div>\n                <div class="form-group">\n                  <label class="form-label">Card Holder Name</label>\n                  <input type="text" class="form-input" id="card-holder" placeholder="Name on card">\n                </div>\n                <div class="form-row">\n                  <div class="form-group">\n                    <label class="form-label">Expiry</label>\n                    <input type="text" class="form-input" id="card-expiry" placeholder="MM/YY" maxlength="5">\n                  </div>\n                  <div class="form-group">\n                    <label class="form-label">CVV</label>\n                    <input type="password" class="form-input" id="card-cvv" placeholder="***" maxlength="4">\n                  </div>\n                </div>\n                <label class="form-checkbox">\n                  <input type="checkbox" checked>\n                  Secure this card for future payments\n                </label>\n                <button class="btn-primary" id="card-submit" ${this.canSubmitCard()?"":"disabled"}>\n                  Authorize\n                </button>\n              </div>\n            </div>\n          </div>\n\n          \x3c!-- Net Banking --\x3e\n          <div class="accordion-item">\n            <button class="accordion-header ${"netbanking"===o?"active":""}" data-accordion="netbanking">\n              <div class="accordion-icon">${i}</div>\n              <div class="accordion-details">\n                <div class="accordion-title">Net Banking</div>\n                <div class="accordion-desc">e-Mandate via bank account</div>\n              </div>\n              <div class="accordion-chevron">${r}</div>\n            </button>\n            <div class="accordion-content ${"netbanking"===o?"open":""}">\n              <div class="accordion-body" style="padding: 0;">\n                <div class="bank-list">\n                  ${e.map(n=>`\n                    <div class="bank-item ${s===n.code?"selected":""}" data-bank="${n.code}">\n                      <div class="bank-icon">${n.code.substring(0,2)}</div>\n                      <div class="bank-name">${n.name}</div>\n                      <div class="bank-chevron">${d}</div>\n                    </div>\n                  `).join("")}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `}renderResult(){const{result:e}=this.state,t="success"===e.type;this.shadowRoot.innerHTML=`\n      <style>${n}</style>\n      <div class="container">\n        <div class="result-container">\n          <div class="result-icon ${t?"success":"error"}">\n            ${t?o:"✕"}\n          </div>\n          <div class="result-title">${t?"Mandate Authorized!":"Authorization Failed"}</div>\n          <div class="result-message">${e.message}</div>\n        </div>\n        <div class="result-footer">\n          <button class="btn-done ${t?"":"btn-retry"}" id="done-btn">\n            ${t?"Done":"Try Again"}\n          </button>\n        </div>\n      </div>\n    `,this.shadowRoot.getElementById("done-btn").addEventListener("click",()=>{t&&this.returnUrl?window.location.href=this.returnUrl:t||(this.state.result=null,this.render(),this.attachEventListeners())})}canSubmitCard(){const{cardNumber:n,cardExpiry:e,cardCvv:t}=this.state;return n.replace(/\s/g,"").length>=15&&5===e.length&&t.length>=3}attachEventListeners(){this.shadowRoot.querySelectorAll(".accordion-header").forEach(n=>{n.addEventListener("click",n=>{const e=n.currentTarget.dataset.accordion;this.state.activeAccordion=this.state.activeAccordion===e?null:e,this.render(),this.attachEventListeners()})}),this.shadowRoot.querySelectorAll(".bank-item").forEach(n=>{n.addEventListener("click",n=>{this.state.selectedBank=n.currentTarget.dataset.bank,this.handleAuthorize("netbanking")})});const n=this.shadowRoot.getElementById("upi-input");n&&(n.addEventListener("input",n=>{this.state.upiId=n.target.value;const e=this.shadowRoot.getElementById("upi-submit");e&&(e.disabled=!this.state.upiId.includes("@"))}),"upi"===this.state.activeAccordion&&n.focus());const e=this.shadowRoot.getElementById("upi-submit");e&&e.addEventListener("click",()=>this.handleAuthorize("upi"));const t=this.shadowRoot.getElementById("card-number");t&&t.addEventListener("input",n=>{let e=n.target.value.replace(/\D/g,"");e=e.replace(/(\d{4})(?=\d)/g,"$1 "),n.target.value=e,this.state.cardNumber=e,this.updateCardButton()});const a=this.shadowRoot.getElementById("card-holder");a&&a.addEventListener("input",n=>{this.state.cardHolder=n.target.value});const i=this.shadowRoot.getElementById("card-expiry");i&&i.addEventListener("input",n=>{let e=n.target.value.replace(/\D/g,"");e.length>=2&&(e=e.substring(0,2)+"/"+e.substring(2)),n.target.value=e,this.state.cardExpiry=e,this.updateCardButton()});const r=this.shadowRoot.getElementById("card-cvv");r&&r.addEventListener("input",n=>{this.state.cardCvv=n.target.value,this.updateCardButton()});const o=this.shadowRoot.getElementById("card-submit");o&&o.addEventListener("click",()=>this.handleAuthorize("card"))}updateCardButton(){const n=this.shadowRoot.getElementById("card-submit");n&&(n.disabled=!this.canSubmitCard())}async handleAuthorize(n){const e=this.shadowRoot.getElementById(`${n}-submit`)||this.shadowRoot.querySelector(".bank-item.selected");e&&"BUTTON"===e.tagName&&(e.disabled=!0,e.innerHTML='<div class="spinner" style="width:20px;height:20px;border-width:2px;margin:0 auto;"></div>');try{await new Promise(n=>setTimeout(n,2e3));const e=this.buildPayload(n);this.state.result={type:"success",message:"Your mandate has been authorized successfully. Payments will be debited automatically as per schedule."},this.dispatchEvent(new CustomEvent("mandate-success",{detail:{sessionId:this.sessionId,payload:e},bubbles:!0,composed:!0}))}catch(t){this.state.result={type:"error",message:t.message||"Failed to authorize. Please try again."},this.dispatchEvent(new CustomEvent("mandate-failure",{detail:{sessionId:this.sessionId,error:t.message},bubbles:!0,composed:!0}))}this.render()}buildPayload(n){const{selectedBank:e,upiId:t,cardNumber:a,cardExpiry:i}=this.state;return{sessionId:this.sessionId,method:n,..."netbanking"===n&&{bankCode:e},..."upi"===n&&{upiId:t},..."card"===n&&{cardLast4:a.slice(-4),expiry:i}}}}customElements.define("approve-mandate",s)}();
